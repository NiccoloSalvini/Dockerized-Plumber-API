---
title: "Dockerized API Scraping [Immobiliare.it](https://www.immobiliare.it/)"
output: 
  github_document:
    toc: TRUE
    toc_depth: 3
    fig_width: 5
    fig_height: 5
---

<!-- README.md is generated from README.Rmd. Please edit that file -->




```{r global.options, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,  
  strip.white = TRUE,                 # if FALSE knitr will not remove white spaces at the beg or end
  fig.path = "img/",                  # file path to the directory DESTINATION where knitr shall store the
  fig.width=12,                       # the width for plots created by code chunk
  fig.height=8,                       # the height for plots created by code chunk
  cache = FALSE                       # if TRUE knitr will cache the results to reuse in future knits
)


knitr::knit_hooks$set(imgcenter = function(before, options, envir){  # to center image 
  if (before) {                                                      # add imgcenter = TRUE
    htmltools::HTML("<p align='center'>")                            # to the chunk options
  } else {
    htmltools::HTML("</p>")
  }
})
```



<img src="img/logo.png" align="right" height="80" />
 
## API Infrastructure

_author_: **[Niccol√≤ Salvini](https://niccolosalvini.netlify.app/)**
_date_: `r format(Sys.Date(), "%d %B, %Y")`


<br> 

 
This **REST API** provides a way for platform/language independent access to the public [Immobiliare.it](https://www.immobiliare.it/) database of Real Estate rental market. By default it provides to the scraping functions the corrisponding Milan url connected to its Real Estate market, it will be possible for sure to provide only the city information in the very next future. It can be extended also for other cities by providing different urls. API are managed by `Plumber` which is a R framework to build APIs. They are containerized in a Docker container which will be hosted on AWS EC2 server. 
On top of that each day a scheduler runs scraping functions and store daily data on a DB that can be queried by this API ( _in itinere_ ):
<br><br>


```{r FIRENZE, echo=FALSE, imgcenter = TRUE, fig.retina=1}
knitr::include_graphics("img/dpapi.png") 
```


## API Documentation:  

- Get fast raw data, 5 covariates: title, price, num of rooms, sqmeter, primarykey
```r
      GET */scrape

      param url the category link from which you are interested to extract data
      param npages number of pages that are going to be scraped
      content-type: application/json 
```
- Get all the links 

```r
      GET */link

      param url the category link from which you are interested to extract data
      param npages  num of pages you are interested in
      content-type: application/json 
```   
      
-  Get the complete data from single links (not the raw)

```r

      GET */complete

      param url you you want to extract info from
      param npages num of pages you are interested starting from the url param
      content-type: application/json
            

```

 